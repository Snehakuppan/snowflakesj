CREATE TABLE IF NOT EXISTS "SAPHANA_SNFLK"."PUBLIC". "Admission_details"
(Block_floor_roomno NVARCHAR,admission_date NVARCHAR,admission_end_date NVARCHAR,bed_no INTEGER,
 case_id INTEGER,patient_id INTEGER,room_bill INTEGER);
 
ALTER TABLE "SAPHANA_SNFLK"."PUBLIC"."Admission_details" ADD PRIMARY KEY (case_id);

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC". "Admission_details";
DROP TABLE "SAPHANA_SNFLK"."PUBLIC". "Admission_details";

CREATE TABLE "SAPHANA_SNFLK"."PUBLIC". "SJ_PLANES"
(ICAO VARCHAR(100),IATA VARCHAR(100),MAKER VARCHAR(100),DESCRIPTION VARCHAR(100));

DROP TABLE "SAPHANA_SNFLK"."PUBLIC". "SJ_PLANES";

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."SJ_PLANES";


CREATE TABLE "SAPHANA_SNFLK"."PUBLIC". "SJ_COLLEGEDETAIL1"
(College_Name VARCHAR(10) ,College_Branch VARCHAR(20), Course VARCHAR(20), Dept VARCHAR(20),
 Spec_ID INTEGER, Specialization VARCHAR(20), Batch INTEGER,Number_Of_Student INTEGER, Placement FLOAT ,Higher_Studies FLOAT);


SELECT * FROM "SAPHANA_SNFLK"."PUBLIC". "SJ_COLLEGEDETAIL1";

CREATE TABLE "SAPHANA_SNFLK"."PUBLIC". "SJ_DATA"
(ID INTEGER, SOURCE VARCHAR(50), TARGET VARCHAR(50), PIPE_TYPE VARCHAR(50),DIAMETER_M INTEGER, LENGTH_M FLOAT,MATERIAL VARCHAR(50),
 SHAPE_GEO VARCHAR(100) ); 
 
 DROP TABLE "SAPHANA_SNFLK"."PUBLIC". "SJ_DATA";
 
create table "SAPHANA_SNFLK"."PUBLIC"."geospatial_table"(g geography);
insert into "SAPHANA_SNFLK"."PUBLIC"."geospatial_table"  select st_geogpointfromgeohash('010200002091080000120000000080990957C03A410000A17F11C0544100005AB456C03A4100A03CBC11C0544100801A5F56C03A4100A0E8F811C054410000DB0956C03A410040843512C0544100809BB455C03A410060307212C0544100809D5F55C03A410060DCAE12C0544100005E0A55C03A41000078EB12C0544100801EB554C03A410000242813C054410000DF5F54C03A4100C0BF6413C0544100809F0A54C03A4100C06BA113C05441008060B553C03A41006007DE13C054410000216053C03A410060B31A14C054410080E10A53C03A4100605F5714C054410080E3B552C03A410020FB9314C054410000A46052C03A410020A7D014C054410080640B52C03A4100C0420D15C05441000025B651C03A4100C0EE4915C054410080E56051C03A4100E09A8615C05441');
    
 SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."geospatial_table";
 
 alter session set geography_output_format='GeoJSON';
 alter session set geography_output_format='WKB';
 
select st_geographyfromewkb('0102000020910800000300000000809BF4D6B83A4100C0178E7CBC544100002F2DE6B83A410020280682BC54410000AA61EAB83A4100A0908783BC5441');
alter session set geography_output_format='EWKB';
select st_geogpointfromgeohash('9q9j8ue2v71y5zzy0s4q')as geography_center_point_of_geohash;

select st_geogpointfromgeohash('010200002091080000120000000080990957C03A410000A17F11C0544100005AB456C03A4100A03CBC11C0544100801A5F56C03A4100A0E8F811C054410000DB0956C03A410040843512C0544100809BB455C03A410060307212C0544100809D5F55C03A410060DCAE12C0544100005E0A55C03A41000078EB12C0544100801EB554C03A410000242813C054410000DF5F54C03A4100C0BF6413C0544100809F0A54C03A4100C06BA113C05441008060B553C03A41006007DE13C054410000216053C03A410060B31A14C054410080E10A53C03A4100605F5714C054410080E3B552C03A410020FB9314C054410000A46052C03A410020A7D014C054410080640B52C03A4100C0420D15C05441000025B651C03A4100C0EE4915C054410080E56051C03A4100E09A8615C05441')as geography_center_point_of_geohash;


select * from doctor_details;

CREATE TABLE CML_WASTE_WATER_EDGES (ID INT  Primary Key,SOURCE VARCHAR, TARGET VARCHAR, PIPE_TYPE VARCHAR, PIPE_USE VARCHAR, DIAMETER_M DOUBLE, LENGTH_M DOUBLE, MATERIAL VARCHAR, SHAPE_GEO BINARY);

DROP TABLE "SAPHANA_SNFLK"."PUBLIC". "DOCTOR_DETAILS";



"SAPHANA_SNFLK"."PUBLIC"."Admission_details"CREATE VIEW "SAPHANA_SNFLK"."PUBLIC"."SJ_AIRBUS" AS
SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."SJ_PLANES"
WHERE MAKER = 'Airbus';

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."SJ_PLANES";

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_EDGES";

DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."SJ_PLANES";
SELECT SHAPE_GEO FROM "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_EDGES";

INSERT INTO "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_EDGES" VALUES('3583383', 'WCC_SW000377', 'WCC_SW040891', 'Main','', '225', '19.06', 'RCON','001100000011000100110000001100100011000000110000001100000011000000110010001100000011100100110001001100000011100000110000001100000011000000110000001100000011001000110000001100000011000000110000001100000011000000110000001100000011000000110000010001100100001100110001001110010011010000110101010000010011100100110011010000010011010000110001001100000011000000110000001100000100001101000101010001000011100100110010010001100100001000110111001101010011010000110100001100010011000000110000001100000011000001000110010000110100011000111001001100110011100001000001001110010011001101000001001101000011000100110000001100000011001000110000001101110100010100110010010000110011001001000011010000100011011100110101001101000011010000110001');

Select * from "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_EDGES"
DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."ADMISSION_DETAILS";
DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."CROP_PRODUCTION";
DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_EDGES";
DROP VIEW "SAPHANA_SNFLK"."PUBLIC".sk_criticalpatient_month;

CREATE VIEW SJ_VIEWS AS SELECT "ADMISSION_DATE","ADMISSION_END_DATE"SAPHANA_SNFLK"."PUBLIC"."SJ_VIEWS"" from "SAPHANA_SNFLK"."PUBLIC"."ADMISSION_DETAILS";

CREATE VIEW sk_criticalpatient_month as SELECT count(*) as criticalcount,substring(cast("ADMISSION_DATE" as varchar(10)),1,8)as septojan from "SAPHANA_SNFLK"."PUBLIC"."ADMISSION_DETAILS" group by substring(cast("ADMISSION_DATE" as varchar(10)),1,8);

select to_char(SEPTOJAN,"yyyy-mm-dd") from sk_criticalpatient_month;
DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."ADMISSION_DETAILS";

DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."CROP_PRODUCTION";

DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_EDGES";

DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_VERTICES";

DROP TABLE "SAPHANA_SNFLK"."PUBLIC"."DOCTOR_DETAILS";

SELECT TOP 1000
"PATIENT_ID",
"CASE_ID",
"ADMISSION_DATE",
"BLOCK_FLOOR_ROOMNO",
"BED_NO",
"ADMISSION_END_DATE",
"ROOM_BILL",
AVG("ROOM_BILL") AS "AVG_ROOMBILL",
SUM("ROOM_BILL") AS "SUM_ROOMBILL"
FROM "SAPHANA_SNFLK"."PUBLIC"."ADMISSION_DETAILS"
GROUP BY "PATIENT_ID","CASE_ID","ADMISSION_DATE","BLOCK_FLOOR_ROOMNO","BED_NO","ADMISSION_END_DATE","ROOM_BILL";


SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."ADMISSION_DETAILS";

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."CROP_PRODUCTION";

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_EDGES";

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."CML_WASTE_WATER_VERTICES";

SELECT * FROM "SAPHANA_SNFLK"."PUBLIC"."DOCTOR_DETAILS";





